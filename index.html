let gameRunning = true; // novo flag para controlar o loop

function gameLoop(){
    if(!gameRunning) return; // pausa total se colidiu
    obstacles.forEach((obs,index)=>{
        let pos=parseInt(obs.style.left);
        pos-=gameSpeed;
        obs.style.left = pos + 'px';
        if(pos+obs.offsetWidth<0){
            obs.remove();
            obstacles.splice(index,1);
        }
        if(collision(dino,obs)){
            pauseGame();       // pausa o jogo
            showQuestion(obs); // mostra pergunta
        }
    });
    requestAnimationFrame(gameLoop);
}

function pauseGame(){
    gameRunning = false;
    clearInterval(scoreInterval);
    clearInterval(obstacleInterval);
}

function resumeGame(){
    gameRunning = true;
    scoreInterval = setInterval(()=>{
        score++;
        document.getElementById('score').textContent = score;
        if(score%100===0) gameSpeed += 0.5;
    },100);
    obstacleInterval = setInterval(spawnObstacle,1500);
    requestAnimationFrame(gameLoop);
}

function selectAnswer(selected, correct){
    const buttons = document.querySelectorAll('.option');
    buttons.forEach((b,i)=>{
        b.disabled = true;
        if(i === correct) b.classList.add('correct');
        else if(i === selected) b.classList.add('incorrect');
    });

    if(selected === correct){
        score += 50;
        document.getElementById('continueBtn').style.display = 'block';
        document.getElementById('continueBtn').onclick = () => {
            document.getElementById('questionModal').style.display = 'none';
            document.getElementById('continueBtn').style.display = 'none';
            resumeGame(); // retoma o jogo somente quando acertar
        }
    } else {
        // se errou, n√£o libera o jogo, pode mostrar mensagem "Tente novamente"
        alert("Resposta incorreta! Tente novamente para continuar.");
    }
}
